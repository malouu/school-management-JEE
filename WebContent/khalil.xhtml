<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:p="http://primefaces.org/ui"
>
  <f:view contentType="text/html;charset=UTF-8" encoding="UTF-8">
    <f:metadata>
      <f:viewAction action="#{studentMB.initDataTable}" />
    </f:metadata>
    <h:head> </h:head>
    <h:body>
      <h:form>
        <p:menubar style="background-color: tomato">
          <f:facet name="options">
            <p:button
              styleClass=" ui-button-flat"
              style="color: white"
              value="Groups"
            />
            <p:button
              styleClass=" ui-button-flat"
              style="color: white"
              value="Teachers"
            />
            <p:button
              styleClass=" ui-button-flat"
              style="color: white"
              value="Settings"
              icon="pi pi-fw pi-cog"
            />
            <p:button
              styleClass="ui-button-flat"
              style="color: white"
              value="Logout"
              icon="pi pi-fw pi-sign-out"
            />
          </f:facet>
        </p:menubar>
        <br />
      </h:form>

      <div class="card crud-demo">
        <h:form id="form">
          <p:growl id="messages" showDetail="true" />

          <p:toolbar>
            <p:toolbarGroup>
              <p:commandButton
                value="New"
                icon="pi pi-plus"
                actionListener="#{studentMB.openNew}"
                update=":dialogs:manage-product-content"
                oncomplete="PF('manageProductDialog').show()"
                styleClass="ui-button-success"
                style="margin-right: 0.5rem"
              >
                <p:resetInput target=":dialogs:manage-product-content" />
              </p:commandButton>
              <p:commandButton
                id="delete-products-button"
                value="#{studentMB.deleteButtonMessage}"
                icon="pi pi-trash"
                actionListener="#{studentMB.deleteSelectedStudents}"
                styleClass="ui-button-danger"
                disabled="#{studentMB.hasnotSelectedStudents()}"
                update="@this"
              >
                <p:confirm
                  header="Confirmation"
                  message="Delete the selected students?"
                  icon="pi pi-exclamation-triangle"
                />
              </p:commandButton>
            </p:toolbarGroup>
            <p:toolbarGroup align="right">
              <p:fileUpload
                mode="simple"
                skinSimple="true"
                label="Import"
                chooseIcon="pi pi-download"
              />
              <p:commandButton
                value="Export"
                icon="pi pi-upload"
                styleClass="ui-button-help"
                ajax="false"
              >
                <p:dataExporter
                  type="pdf"
                  target="dt-students"
                  fileName="students"
                />
              </p:commandButton>
            </p:toolbarGroup>
          </p:toolbar>

          <p:dataTable
            id="dt-students"
            widgetVar="dtStudents"
            var="product"
            value="#{studentMB.students}"
            reflow="true"
            styleClass="products-table"
            selection="#{studentMB.selectedStudents}"
            rowKey="#{student.subscription_number}"
            paginator="true"
            rows="10"
            rowSelectMode="add"
            paginatorPosition="bottom"
          >
            <f:facet name="header">
              <div class="products-table-header">
                <span style="font-weight: bold">STUDENTS</span>
                <span class="filter-container ui-input-icon-left">
                  <i class="pi pi-search"></i>
                  <p:inputText
                    id="globalFilter"
                    onkeyup="PF('dtStudents').filter()"
                    placeholder="Search"
                  />
                </span>
              </div>
            </f:facet>

            <p:ajax event="rowSelect" update=":form:delete-products-button" />
            <p:ajax event="rowUnselect" update=":form:delete-products-button" />
            <p:ajax
              event="rowSelectCheckbox"
              update=":form:delete-products-button"
            />
            <p:ajax
              event="rowUnselectCheckbox"
              update=":form:delete-products-button"
            />
            <p:ajax
              event="toggleSelect"
              update=":form:delete-products-button"
            />

            <p:column selectionMode="multiple" exportable="false"></p:column>

            <p:column
              headerText="Subscription Number"
              sortBy="#{student.subscription_number}"
              filterBy="#{student.subscription_number}"
            >
              <h:outputText value="#{student.subscription_number}" />
            </p:column>
            <p:column
              headerText="Name"
              sortBy="#{student.name}"
              filterBy="#{student.name}"
            >
              <h:outputText value="#{student.name}" />
            </p:column>

            <p:column
              headerText="Surname"
              sortBy="#{student.surname}"
              filterBy="#{student.surname}"
            >
              <h:outputText value="#{student.surname}" />
            </p:column>

            <p:column exportable="false">
              <p:commandButton
                icon="pi pi-pencil"
                update=":dialogs:manage-product-content"
                oncomplete="PF('manageProductDialog').show()"
                styleClass="edit-button rounded-button ui-button-success"
                process="@this"
              >
                <f:setPropertyActionListener
                  value="#{student}"
                  target="#{studentMB.selectedStudent}"
                />
                <p:resetInput target=":dialogs:manage-product-content" />
              </p:commandButton>
              <p:commandButton
                class="ui-button-warning rounded-button"
                icon="pi pi-trash"
                process="@this"
                oncomplete="PF('deleteProductDialog').show()"
              >
                <f:setPropertyActionListener
                  value="#{student}"
                  target="#{studentMB.selectedStudent}"
                />
              </p:commandButton>
            </p:column>
          </p:dataTable>
        </h:form>

        <h:form id="dialogs">
          <p:dialog
            header="Student Details"
            showEffect="fade"
            modal="true"
            widgetVar="manageProductDialog"
            responsive="true"
          >
            <p:outputPanel id="manage-product-content" class="ui-fluid">
              <p:outputPanel rendered="#{not empty studentMB.selectedStudent}">
                <div class="field">
                  <p:outputLabel for="name">Name</p:outputLabel>
                  <p:inputText
                    id="name"
                    value="#{studentMB.selectedStudent.name}"
                    required="true"
                  />
                </div>

                <div class="field">
                  <p:outputLabel for="surname">Surname</p:outputLabel>
                  <p:selectOneRadio
                    id="surname"
                    value="#{studentMB.selectedStudent.surname}"
                    layout="responsive"
                    columns="2"
                  >
                    <f:selectItem
                      itemLabel="Accessories"
                      itemValue="Accessories"
                    />
                    <f:selectItem itemLabel="Clothing" itemValue="Clothing" />
                    <f:selectItem
                      itemLabel="Electronics"
                      itemValue="Electronics"
                    />
                    <f:selectItem itemLabel="Fitness" itemValue="Fitness" />
                  </p:selectOneRadio>
                </div>
              </p:outputPanel>
            </p:outputPanel>

            <f:facet name="footer">
              <p:commandButton
                value="Save"
                icon="pi pi-check"
                actionListener="#{studentMB.saveStudent}"
                update="manage-product-content"
                process="manage-product-content @this"
              />
              <p:commandButton
                value="Cancel"
                icon="pi pi-times"
                onclick="PF('manageProductDialog').hide()"
                class="ui-button-secondary"
                type="button"
              />
            </f:facet>
          </p:dialog>

          <p:confirmDialog
            widgetVar="deleteProductDialog"
            showEffect="fade"
            width="300"
            message="Delete the product?"
            header="Confirm"
            severity="warn"
          >
            <p:commandButton
              value="Yes"
              icon="pi pi-check"
              actionListener="#{studentMB.deleteStudent}"
              process="@this"
              update=":form:delete-products-button"
              oncomplete="PF('deleteProductDialog').hide()"
            />
            <p:commandButton
              value="No"
              type="button"
              styleClass="ui-button-secondary"
              icon="pi pi-times"
              onclick="PF('deleteProductDialog').hide()"
            />
          </p:confirmDialog>

          <p:confirmDialog global="true" showEffect="fade" width="300">
            <p:commandButton
              value="Yes"
              type="button"
              styleClass="ui-confirmdialog-yes"
              icon="pi pi-check"
            />
            <p:commandButton
              value="No"
              type="button"
              styleClass="ui-confirmdialog-no ui-button-secondary"
              icon="pi pi-times"
            />
          </p:confirmDialog>
        </h:form>
      </div>
    </h:body>
  </f:view>
</html>
