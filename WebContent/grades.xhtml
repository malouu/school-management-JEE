<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:p="http://primefaces.org/ui"
>
  <f:view contentType="text/html;charset=UTF-8" encoding="UTF-8">
    <f:metadata>
      <f:viewAction action="#{gradesMB.initDataTable}" />
    </f:metadata>

    <h:head>
      <title>Grades</title>
    </h:head>

    <h:form id="form">
      <p:growl id="msgs" showDetail="true" />
      <div class="card">
        <h5>Double click to edit grade</h5>
        <p:dataTable
          id="students"
          var="student"
          value="#{gradesMB.students}"
          editable="true"
          editMode="cell"
          widgetVar="cellCars2"
          editInitEvent="dblclick"
          style="margin-bottom: 20px"
        >
          <p:ajax
            event="cellEdit"
            listener="#{gradesMB.onCellEdit}"
            update=":form:msgs"
          />

          <p:column headerText="Subscription Number">
            <p:cellEditor>
              <f:facet name="output">
                <h:outputText value="#{student.subscription_number}" />
              </f:facet>
              <f:facet name="input">
                <p:inputText
                  id="modelInput3"
                  value="#{student.subscription_number}"
                  style="width: 100%"
                />
              </f:facet>
            </p:cellEditor>
          </p:column>

          <p:column headerText="Name">
            <p:cellEditor>
              <f:facet name="output">
                <h:outputText value="#{student.name}" />
              </f:facet>
              <f:facet name="input">
                <p:inputText
                  value="#{student.name}"
                  style="width: 100%"
                  label="Name"
                />
              </f:facet>
            </p:cellEditor>
          </p:column>

          <p:column headerText="Surname">
            <p:cellEditor>
              <f:facet name="output">
                <h:outputText value="#{student.surname}" />
              </f:facet>
              <f:facet name="input">
                <p:inputText
                  value="#{student.surname}"
                  style="width: 100%"
                  label="Surname"
                />
              </f:facet>
            </p:cellEditor>
          </p:column>

          <p:columns
            value="#{gradesMB.columns}"
            var="column"
            headerText="#{column.header}"
          >
            <p:cellEditor>
              <f:facet name="output">
                <h:outputText
                  value="#{gradesMB.studentService.getStudentCourseGradewithType(student,column.property).value}"
                />
              </f:facet>
              <f:facet name="input">
                <p:inputText
                  value="#{gradesMB.studentService.getStudentCourseGradewithType(student,column.property).value}"
                  style="width: 100%"
                  label="Grade"
                />
              </f:facet>
            </p:cellEditor>
          </p:columns>
        </p:dataTable>
      </div>
    </h:form>
  </f:view>
</html>
